<div class="bm-page">
  <div class="bm-dashboard-bg"></div>

  <div class="bm-dashboard-layout">
    <!-- 1. Minimal Header -->
    <header class="bm-dash-header">
      <div class="bm-dash-welcome">
        <!-- Date or personalized greeting could go here, staying minimal for now -->
      </div>
    </header>

    <!-- 2. Primary Focus: Songs (Library) -->
    <section class="bm-practice-hero" aria-label="Music Library">
      <div class="bm-hero-content">
        <!-- Removed "Focus Area" label -->
        <h2 class="bm-hero-headline">Ready to play?</h2>
        <p class="bm-hero-desc">Choose a song from your library and start playing.</p>

        <a mat-flat-button class="bm-hero-cta" routerLink="/songs">
          <mat-icon>play_circle</mat-icon>
          Start Playing
        </a>
      </div>

      <!-- Subtle visual cue: Musical texture -->
      <div class="bm-hero-visual">
        <mat-icon class="bm-hero-icon">library_music</mat-icon>
      </div>
    </section>

    <!-- 2.5 Continuity Block (New) -->
    <section class="bm-continuity-section" aria-label="Recent Activity">
      @if (lastSong(); as last) {
        <div class="bm-continuity-card">
          <div class="bm-cont-info">
            <div class="bm-cont-label">Continue where you left off</div>
            <div class="bm-cont-title">{{ last.song.title }}</div>
            <div class="bm-cont-meta">
              {{ last.song.artist }}
              @if (last.song.key) {
                • {{ last.song.key }}
              }
              @if (last.song.bpm) {
                • {{ last.song.bpm }} BPM
              }
              <span class="bm-cont-time">• {{ relativeTimeLabel() }}</span>
            </div>
          </div>

          <div class="bm-cont-actions">
            <!-- Secondary link -->
            <a class="bm-cont-link" [routerLink]="['/songs']" fragment="{{ last.song.id }}">
              View in Library
            </a>

            <!-- Primary continue -->
            <button mat-stroked-button class="bm-cont-btn" (click)="continueSession()">
              <mat-icon>play_arrow</mat-icon>
              Continue
            </button>
          </div>
        </div>
      } @else {
        <!-- Empty State -->
        <div class="bm-continuity-empty">
          <span class="bm-cont-label">You haven't practiced recently.</span>
          <a class="bm-cont-link" routerLink="/songs"
            >Explore Songs <mat-icon>arrow_forward</mat-icon></a
          >
        </div>
      }
    </section>

    <!-- 3. Secondary Actions -->
    <section class="bm-secondary-grid" aria-label="Secondary Navigation">
      <a class="bm-action-card" routerLink="/setlists">
        <div class="bm-action-icon">
          <mat-icon>queue_music</mat-icon>
        </div>
        <div class="bm-action-text">
          <div class="bm-action-title">Setlists</div>
          <div class="bm-action-desc">Prepare for gigs</div>
        </div>
        <mat-icon class="bm-action-arrow">arrow_forward</mat-icon>
      </a>

      <!-- Practice as a supporting mode, distinct from 'Start Playing' flow -->
      <a class="bm-action-card" routerLink="/practice">
        <div class="bm-action-icon">
          <mat-icon>fitness_center</mat-icon>
        </div>
        <div class="bm-action-text">
          <div class="bm-action-title">Practice Mode</div>
          <div class="bm-action-desc">Free session</div>
        </div>
        <mat-icon class="bm-action-arrow">arrow_forward</mat-icon>
      </a>
    </section>

    <!-- 4. Emotive Stats Strip -->
    @if (!practiceStats.isLoading()) {
      <section class="bm-stats-strip" aria-label="Your Progress">
        <div class="bm-stat-item">
          <span class="bm-stat-val">{{ practiceStats.summary()?.week?.sessionCount || 0 }}</span>
          <span class="bm-stat-label">Sessions this week</span>
        </div>

        <div class="bm-stat-divider"></div>

        <div class="bm-stat-item">
          <span class="bm-stat-val">{{
            practiceStats.formatDuration(practiceStats.summary()?.week?.totalSeconds || 0)
          }}</span>
          <span class="bm-stat-label">Time in flow</span>
        </div>

        <div class="bm-stat-divider"></div>

        <div class="bm-stat-item">
          <span class="bm-stat-val">{{ practiceStats.streak() }}</span>
          <span class="bm-stat-label">Day streak</span>
        </div>
      </section>
    }
  </div>
</div>
